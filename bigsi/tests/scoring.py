from hypothesis import given
from hypothesis import example
import hypothesis.strategies as st

import os

from bigsi.scoring import Scorer


def test_score():
    s = "1111111111111111111111111111111111111111110000000000000000000000000000001111111111111111111111100000000000000000000100000010001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000100000000010001111111111000000000000100000000000000000000000000000000100000000000010000000010000001000000000010000000000000000010001111111100000000000001100010000000000000000000001000000000000110000000000000000000000100000000000000000000100000000000000001010001111111111100000000000000000000100100010011111111111111111100000000001001000001000000000000000000000000000001000000010100000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111100000010110001000100000000000000000000000000000000000001000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100010000000100000000001010000001111111111111111111111111111111111111111111111111111111111111111100100000000010000000010000000001111111111111111111111111111111111111111111111111111111111111111111111100000100000000000010000000000000010000000011111111000000100010"
    scorer = Scorer(5*10**5)
    assert scorer.score(s) == {'length': 1174,
                               'max_mismatches': 269,
                               'max_nident': 1156,
                               'max_pident': 98.46678023850085,
                               'max_score': 1119.98,
                               'min_mismatches': 18,
                               'min_nident': 905,
                               'min_pident': 77.08688245315162,
                               'min_score': 96.04,
                               'mismatches': 33,
                               'nident': 1141,
                               'pident': 97.18909710391823,
                               'score': 1064.89,
                               'evalue': 0.0,
                               'pvalue': 0.0,
                               'log_evalue': -1407.74,
                               'log_pvalue': -1407.74}
